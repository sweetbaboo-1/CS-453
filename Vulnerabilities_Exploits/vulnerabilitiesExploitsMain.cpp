#include <stdio.h>
#include <string>
#include <iostream>
#include <iomanip>
#include <cassert>
using namespace std;

#include "ansi.cpp"
#include "integer.cpp"
#include "arcInjection.cpp"
#include "vtable.cpp"

int vulnerabilitiesExploitsMain()

{
	bool keepRunning = true;
	string userInput = "";

	while (keepRunning)
	{
		cout << "\n1. Array Index"
			 << "\n2. ARC Injection"
			 << "\n3. VTable Spraying"
			 << "\n4. Stack Smashing"
			 << "\n5. Heap Smashing"
			 << "\n6. Integer Overflow"
			 << "\n7. ANSI-Unicode Conversion"
			 << "\nQ. Exit\n";
		cin >> userInput;

		if (userInput == "1")
			cout << "Array Index" << endl;
		else if (userInput == "2"){
			cout << "Arc Injection vulnerability" << endl;
			arcWorking();
			arcExploit();
		}
		else if (userInput == "3"){
			cout << "V-Table Spraying" << endl;
			vtableWorking();
		}
		else if (userInput == "4")
			cout << "Stack Smashing" << endl;
		else if (userInput == "5")
			cout << "Heap Smashing" << endl;
		else if (userInput == "6")
			integerMain();
		else if (userInput == "7")
			ansiMain();

		else if (userInput == "q" || userInput == "Q") // exit
		{
			cout << "Thank you, goodbye\n";
			keepRunning = false;
		}
		else
			cout << "Please enter a valid option\n";
	}
	return 0;
}
